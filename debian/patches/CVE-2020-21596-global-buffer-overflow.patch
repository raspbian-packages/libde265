Description: Fix CVE-2020-21596 global buffer overflow in decode_CABAC_bit when decoding file
Origin: https://github.com/strukturag/libde265/commit/6751f4e3c8c7af63d0036fedd506b7932630773c
From 6751f4e3c8c7af63d0036fedd506b7932630773c Mon Sep 17 00:00:00 2001
From: Dirk Farin <dirk.farin@gmail.com>
Date: Tue, 24 Jan 2023 19:01:42 +0100
Subject: [PATCH] initialize newly created CABAC model table when (fixes #236)

---
 libde265/contextmodel.cc | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/libde265/contextmodel.cc b/libde265/contextmodel.cc
index ec432281d..7244471f9 100644
--- a/libde265/contextmodel.cc
+++ b/libde265/contextmodel.cc
@@ -181,6 +181,8 @@ void context_model_table::decouple_or_alloc_with_empty_data()
   if (D) printf("%p (alloc)\n",this);
 
   model = new context_model[CONTEXT_MODEL_TABLE_LENGTH];
+  // Without initializing the model, we got an invalid model state during decoding (issue #236)
+  memset(model, 0, sizeof(context_model) * CONTEXT_MODEL_TABLE_LENGTH);
   refcnt= new int;
   *refcnt=1;
 }
